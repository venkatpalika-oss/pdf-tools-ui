<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Compress PDF – Reduce PDF File Size Online</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- META -->
  <meta name="description"
        content="Compress PDF files online to reduce file size while keeping quality intact." />

  <!-- GLOBAL CSS -->
  <link rel="stylesheet" href="../assets/css/style.css" />
</head>

<body data-tool="compress">

<!-- ================= GLOBAL HEADER ================= -->
<div id="site-header"></div>

<!-- ================= TOOL PAGE ================= -->
<section class="hero">
  <div class="container hero-inner">

    <h1>Compress PDF</h1>
    <p class="hero-sub">
      Reduce PDF file size without losing quality.
    </p>

    <!-- FORM -->
    <form id="compressForm">

      <!-- UPLOAD BOX -->
      <div class="upload-box" id="dropZone">
        <input
          type="file"
          id="fileInput"
          class="file-input"
          accept="application/pdf"
          hidden
          required
        />

        <div class="upload-icon">⬆️</div>
        <p class="upload-title" id="fileLabel">
          Choose a PDF file or drag & drop here
        </p>
        <p class="upload-hint">Supported format: PDF</p>
      </div>

      <!-- COMPRESSION LEVEL -->
      <div style="margin-top:20px;text-align:center;">
        <select id="levelSelect" style="padding:10px;border-radius:6px;">
          <option value="screen">Smallest Size (Low Quality)</option>
          <option value="ebook" selected>Balanced</option>
          <option value="printer">High Quality</option>
          <option value="prepress">Maximum Quality</option>
        </select>
      </div>

      <!-- SUBMIT BUTTON -->
      <div style="margin-top:20px;text-align:center;">
        <button type="submit" class="btn-primary">
          Compress PDF
        </button>
      </div>

    </form>

    <!-- RESULT AREA -->
    <div id="resultBox" style="margin-top:25px;text-align:center;"></div>

  </div>
</section>

<!-- ================= INFO SECTION ================= -->
<section class="tools">
  <div class="container">
    <p class="hero-sub" style="max-width:720px;margin:auto;text-align:center;">
      Compress large PDF files for easier sharing,
      faster uploads, and reduced storage usage.
    </p>
  </div>
</section>

<!-- ================= GLOBAL FOOTER ================= -->
<div id="site-footer"></div>

<!-- ================= SCRIPTS ================= -->
<script src="../assets/js/includes.js"></script>
<script src="../assets/js/app.js" defer></script>

<script>
const dropZone = document.getElementById("dropZone");
const fileInput = document.getElementById("fileInput");
const fileLabel = document.getElementById("fileLabel");
const form = document.getElementById("compressForm");
const resultBox = document.getElementById("resultBox");
const levelSelect = document.getElementById("levelSelect");

/* ================= CLICK TO OPEN FILE ================= */
dropZone.addEventListener("click", () => {
  fileInput.click();
});

/* ================= DRAG & DROP ================= */
dropZone.addEventListener("dragover", (e) => {
  e.preventDefault();
  dropZone.classList.add("drag-active");
});

dropZone.addEventListener("dragleave", () => {
  dropZone.classList.remove("drag-active");
});

dropZone.addEventListener("drop", (e) => {
  e.preventDefault();
  dropZone.classList.remove("drag-active");

  if (e.dataTransfer.files.length) {
    fileInput.files = e.dataTransfer.files;
    fileLabel.textContent = e.dataTransfer.files[0].name;
  }
});

/* ================= FILE SELECT ================= */
fileInput.addEventListener("change", () => {
  if (fileInput.files.length) {
    fileLabel.textContent = fileInput.files[0].name;
  }
});

/* ================= FORM SUBMIT ================= */
form.addEventListener("submit", async (e) => {
  e.preventDefault();

  if (!fileInput.files.length) {
    alert("Please select a PDF file");
    return;
  }

  const formData = new FormData();
  formData.append("file", fileInput.files[0]);
  formData.append("level", levelSelect.value);

  resultBox.innerHTML = "⏳ Compressing... Please wait";

  try {
    const response = await fetch(
      "https://pdf-tools-api-c4f5.onrender.com/api/compress",
      {
        method: "POST",
        body: formData
      }
    );

    const data = await response.json();

    if (!response.ok) {
      throw new Error(data.error || "Compression failed");
    }

    resultBox.innerHTML = `
      <div style="margin-top:15px;">
        ✅ Compression Successful<br><br>
        <a href="${data.downloadUrl}" target="_blank" class="btn-primary">
          Download Compressed PDF
        </a>
      </div>
    `;

  } catch (error) {
    resultBox.innerHTML = `❌ Error: ${error.message}`;
  }
});
</script>

</body>
</html>
